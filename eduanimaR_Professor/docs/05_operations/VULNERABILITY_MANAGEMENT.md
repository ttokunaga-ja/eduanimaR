# VULNERABILITY_MANAGEMENT

## 目的
脆弱性を「検知して終わり」にせず、
トリアージ→修正→リリース→再発防止までを運用として確立する。

本書は NIST SSDF の “Respond to Vulnerabilities (RV)” をプロジェクト運用に落とす。

## 適用範囲
- 自社コード（Go/TS）
- 依存関係（Go modules / Node packages）
- コンテナイメージ、OSパッケージ
- IaC（K8s manifests 等）

## 入口（検知源）
- 依存スキャン（SCA）
- コンテナスキャン
- SAST（静的解析）
- ペネトレーションテスト/バグ報奨金
- 外部報告（security@ など）

## トリアージ（MUST）
- 影響（Exposure）を最初に判断する
  - 到達可能か（インターネット露出 / 認証必須 / 内部のみ）
  - 実際に利用している機能か（到達不能なコードなら優先度は下がる）
  - 機微データに触れるか
- 重大度は CVSS だけで決めず、**業務影響**も加味する

## 目標SLA（テンプレ）
- Critical: 24–72時間以内に修正方針決定、可能なら即時リリース
- High: 7日以内
- Medium: 30日以内
- Low: 次回の定期アップデート

> 実際の数値は組織要件に合わせて調整。

## 修正の原則
- 依存関係: まずは安全なバージョンへ更新（最短経路）
- 自社コード: 再現手順/PoC/攻撃経路を明確化し、根本原因を修正
- 迂回策（mitigation）は期限つきにし、恒久修正へ移行

## リリース/周知
- 変更は通常の CI/CD を通す（例外は緊急手順で明文化）
- リリースノートに “セキュリティ修正” を明記（公開範囲は組織方針）
- 影響が大きい場合、顧客/関係者への連絡テンプレを用意

## 例外（Risk Acceptance）
- 直ちに修正できない場合は、
  - 影響範囲
  - 一時緩和策
  - 恒久対応の期限
  - 承認者
  を記録し、期限管理する（放置を防ぐ）

## SBOM / VEX（推奨）
- SBOM を生成して保管（どの成果物に何が入っているか）
- “影響なし/緩和済み” を説明する必要がある場合は VEX 相当の記録を残す

## 指標（推奨）
- MTTR（検知→本番反映まで）
- 期限超過件数
- 依存更新の頻度
- 例外承認の件数と期限超過

## 関連
- `05_operations/CI_CD.md`
- `05_operations/SUPPLY_CHAIN_SECURITY.md`
- `05_operations/INCIDENT_POSTMORTEM.md`
- `05_operations/API_SECURITY.md`
- `05_operations/SECRETS_KEY_MANAGEMENT.md`
- `05_operations/AUDIT_LOGGING.md`
- NIST SSDF: https://csrc.nist.gov/Projects/ssdf
